(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{335:function(t,s,n){"use strict";n.r(s);var a=n(40),e=Object(a.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h3",{attrs:{id:"如何解决跨域问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何解决跨域问题","aria-hidden":"true"}},[t._v("#")]),t._v(" 如何解决跨域问题")]),t._v(" "),n("hr"),t._v(" "),n("p",[n("strong",[t._v("JSONP：")])]),t._v(" "),n("ul",[n("li",[t._v("原理是：动态插入"),n("code",[t._v("script")]),t._v("标签，通过"),n("code",[t._v("script")]),t._v("标签引入一个"),n("code",[t._v("js")]),t._v("文件，这个"),n("code",[t._v("js")]),t._v("文件载入成功后会执行我们在"),n("code",[t._v("url")]),t._v("参数中指定的函数，并且会把我们需要的"),n("code",[t._v("json")]),t._v("数据作为参数传入")]),t._v(" "),n("li",[t._v("由于同源策略的限制，"),n("code",[t._v("XmlHttpRequest")]),t._v("只允许请求当前源（域名、协议、端口）的资源，为了实现跨域请求，可以通过"),n("code",[t._v("script")]),t._v("标签实现跨域请求，然后在服务端输出"),n("code",[t._v("JSON")]),t._v("数据并执行回调函数，从而解决了跨域的数据请求")]),t._v(" "),n("li",[t._v("优点是兼容性好，简单易用，支持浏览器与服务器双向通信。缺点是只支持GET请求")]),t._v(" "),n("li",[n("code",[t._v("JSONP")]),t._v("："),n("code",[t._v("json+padding")]),t._v("（内填充），顾名思义，就是把"),n("code",[t._v("JSON")]),t._v("填充到一个盒子里")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createJs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("sUrl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" oScript "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      oScript"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/javascript'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      oScript"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sUrl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'head'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oScript"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createJs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jsonp.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("box")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("box")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("json"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("strong",[t._v("CORS")])]),t._v(" "),n("ul",[n("li",[t._v("服务器端对于"),n("code",[t._v("CORS")]),t._v("的支持，主要就是通过设置"),n("code",[t._v("Access-Control-Allow-Origin")]),t._v("来进行的。如果浏览器检测到相应的设置，就可以允许"),n("code",[t._v("Ajax")]),t._v("进行跨域的访问")])]),t._v(" "),n("p",[n("strong",[t._v("通过修改document.domain来跨子域")])]),t._v(" "),n("ul",[n("li",[t._v("将子域和主域的"),n("code",[t._v("document.domain")]),t._v("设为同一个主域.前提条件：这两个域名必须属于同一个基础域名!而且所用的协议，端口都要一致，否则无法利用"),n("code",[t._v("document.domain")]),t._v("进行跨域。主域相同的使用"),n("code",[t._v("document.domain")])])]),t._v(" "),n("p",[n("strong",[t._v("使用window.name来进行跨域")])]),t._v(" "),n("ul",[n("li",[n("code",[t._v("window")]),t._v("对象有个name属性，该属性有个特征：即在一个窗口("),n("code",[t._v("window")]),t._v(")的生命周期内,窗口载入的所有的页面都是共享一个"),n("code",[t._v("window.name")]),t._v("的，每个页面对window.name都有读写的权限，"),n("code",[t._v("window.name")]),t._v("是持久存在一个窗口载入过的所有页面中的")])]),t._v(" "),n("p",[n("strong",[t._v("使用HTML5中新引进的window.postMessage方法来跨域传送数据")])]),t._v(" "),n("ul",[n("li",[t._v("还有"),n("code",[t._v("flash")]),t._v("、在服务器上设置代理页面等跨域方式。个人认为"),n("code",[t._v("window.name")]),t._v("的方法既不复杂，也能兼容到几乎所有浏览器，这真是极好的一种跨域方法")])]),t._v(" "),n("p",[n("strong",[t._v("如何解决跨域问题?")])]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("jsonp")]),t._v("、 "),n("code",[t._v("iframe")]),t._v("、"),n("code",[t._v("window.name")]),t._v("、"),n("code",[t._v("window.postMessage")]),t._v("、服务器上设置代理页面")])]),t._v(" "),n("li",[n("p",[t._v("如何解决跨域问题?")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("document.domain + iframe")]),t._v("：要求主域名相同 //只能跨子域")]),t._v(" "),n("li",[n("code",[t._v("JSONP(JSON with Padding)``：")]),t._v("response: callback(data)`` //只支持 GET 请求")]),t._v(" "),n("li",[t._v("跨域资源共享"),n("code",[t._v("CORS(XHR2)``：")]),t._v("Access-Control-Allow` //兼容性 IE10+")]),t._v(" "),n("li",[t._v("跨文档消息传输(HTML5)："),n("code",[t._v("postMessage + onmessage")]),t._v("  //兼容性 IE8+")]),t._v(" "),n("li",[n("code",[t._v("WebSocket(HTML5)：new WebSocket(url) + onmessage")]),t._v(" //兼容性 IE10+")]),t._v(" "),n("li",[t._v("服务器端设置代理请求：服务器端不受同源策略限制")])])])])])},[],!1,null,null,null);s.default=e.exports}}]);